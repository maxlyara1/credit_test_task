# Валидация модели кредитного скоринга (ML, Python)

## Описание проекта

Этот проект представляет собой решение тестового задания на позицию Ведущего риск-аналитика (ML) в Альфа-Банке.  Задача проекта - провести валидацию модели кредитного скоринга, то есть оценить ее качество, надежность, устойчивость и справедливость.

**Используемые данные:**  Датасет "Give Me Some Credit" (Kaggle), содержащий информацию о заемщиках, включая финансовые и демографические признаки, а также целевую переменную - факт наличия просроченной задолженности (SeriousDlqin2yrs).

**Используемые инструменты:**

*   **Язык программирования:** Python
*   **Библиотеки:** pandas, numpy, matplotlib, seaborn, scikit-learn, catboost, shap
*   **Среда разработки:** Jupyter Notebook (файл `test_task_ML.ipynb`)

## Структура проекта
*   **`test_task_ML.ipynb`:**  Основной файл проекта.  Содержит весь код (загрузка данных, предобработка, построение модели, оценка, интерпретация, отчет) и подробные комментарии.
*   **`Data Dictionary.xls`:**  Содержит описание признаков датасета.
*   **`cs-training.csv`:**  Файл с данными для обучения и валидации модели.
*   **`cs-test.csv`:** *Не использовался* в итоговом решении, так как в задании явно не требовалось делать предсказания на отдельном тестовом наборе.  Но этот файл *можно* использовать для *дополнительной* проверки модели (после выполнения всех шагов в ноутбуке).

## Шаги решения (в `test_task_ML.ipynb`)

1.  **Анализ и предобработка данных:**
    *   Загрузка данных и определение типов данных.
    *   Обработка пропущенных значений (`MonthlyIncome`, `NumberOfDependents`).
    *   Исследование и обработка выбросов (winsorization, удаление аномальных значений, создание категорий).
    *   Визуализация распределений признаков.
    *   Анализ дисбаланса классов.
    *   Выявление инсайтов по данным

2.  **Построение и оценка модели:**
    *   Разделение данных на обучающую, валидационную и тестовую выборки (60/20/20) со стратификацией по целевой переменной.
    *   Обучение модели CatBoost с подбором гиперпараметров (использовалась ранняя остановка по валидационной выборке).
    *   Расчет метрик качества (AUC-ROC, Precision, Recall, F1-score) на тестовой выборке.
    *   Проверка устойчивости модели с помощью стратифицированной 5-кратной кросс-валидации.

3.  **Интерпретация и этика:**
    *   Интерпретация модели с помощью SHAP values (оценка важности признаков и их влияния на прогноз).
    *   Проверка логичности влияния признаков.
    *   Оценка fairness модели по отношению к разным возрастным группам (расчет FPR и TPR).

4.  **Отчет:**
    *   Подготовка подробного отчета (внутри Jupyter Notebook в формате Markdown) с описанием всех шагов, результатами, выводами и рекомендациями.

## Основные выводы

*   Построенная модель CatBoost обладает хорошей предсказательной способностью (AUC-ROC = 0.8665 на тестовой выборке).
*   Модель устойчива (среднее AUC-ROC на кросс-валидации = 0.8611, стандартное отклонение = 0.0046).
*   Модель лучше выявляет дефолтных заемщиков (Recall = 0.7865), чем обеспечивает точность прогнозов дефолта (Precision = 0.2126).
*   Модель демонстрирует признаки дискриминации по возрасту, чаще ошибочно относя молодых заемщиков к группе риска.
*   Наиболее важные признаки для модели: использование кредитных линий, количество просрочек, возраст.
*   Влияние признаков на прогноз в целом логично и согласуется со здравым смыслом.

## Рекомендации по улучшению

*   Попробовать другие методы борьбы с дисбалансом классов.
*   Попробовать другие модели машинного обучения.
*   Провести более тщательный feature engineering.
*   Использовать более продвинутые методы подбора гиперпараметров.
*   Исследовать и, по возможности, устранить дискриминацию по возрасту.
*   Рассмотреть возможность сбора дополнительных данных.
